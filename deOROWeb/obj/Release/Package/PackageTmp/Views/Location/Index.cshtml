@using deOROWeb.Helper;
@model IEnumerable<deORODataAccess.DTO.LocationDTO>

@{
    ViewBag.Title = @deOROWeb.Resources.Strings.Locations;
}

<link href="~/Content/css/duallistbox/bootstrap-duallistbox.css" rel="stylesheet" />
<script src="~/Scripts/js/plugins/duallistbox/jquery.bootstrap-duallistbox.js"></script>

<script src="~/Scripts/js/plugins/jeditable/jquery.jeditable.js"></script>
<script src="~/Scripts/js/plugins/datatables/jquery.dataTables.editable.js"></script>

<script src="~/Scripts/js/plugins/datepicker/jquery.datetimepicker.js"></script>

<link href="~/Content/css/jplayer/skin/blue.monday/css/jplayer.blue.monday.css" rel="stylesheet" />
<script src="~/Scripts/js/plugins/jplayer/jplayer.playlist.js"></script>
<script src="~/Scripts/js/plugins/jplayer/jquery.jplayer.js"></script>

<script src="~/Scripts/js/plugins/blockUI/jquery.blockUI.js"></script>

<link href="~/Scripts/js/plugins/tooltips/simptip.css" rel="stylesheet" />


<aside class="right-side">

    <section class="content-header">
        <h1>@deOROWeb.Resources.Strings.Locations</h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i>@deOROWeb.Resources.Strings.Home</a></li>
            <li class="active">@deOROWeb.Resources.Strings.Locations</li>
        </ol>
    </section>

    <section class="content">
        <div class="col-md-12">
            <div class="box">
                <div class="box-header">
                    <div class="margin">
                        <div class="pull-left box-tools">
                            <button class="btn btn-primary btn-flat btn-sm" data-toggle="modal" data-target="#popup-modal" id="button-add"><i class="fa  fa-plus"></i>&nbsp;&nbsp;@deOROWeb.Resources.Strings.Add @deOROWeb.Resources.Strings.Location</button>
                            @*<div class="btn-group" role="group">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-primary btn-flat btn-sm" data-toggle="dropdown">
                                        Manage Items
                                        <span class="caret"></span>
                                        <span class="sr-only">Toggle Dropdown</span>
                                    </button>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#" data-toggle="modal" data-target="#popup-modal-add-remove">Add / Remove Items</a></li>
                                        <li><a href="#" data-toggle="modal" data-target="#popup-modal-edit">Edit Items</a></li>
                                    </ul>
                                </div>
                            </div>*@
                        </div>
                    </div>
                </div>
                <div class="box-body table-responsive">
                    <table class="table table-bordered table-striped" id="grid">
                        <thead>
                            <tr>
                                <th>@deOROWeb.Resources.Strings.CustomerName</th>
                                <th>@deOROWeb.Resources.Strings.Name</th>
                                <th>@deOROWeb.Resources.Strings.Code</th>
                                <th>@deOROWeb.Resources.Strings.EmailAddress</th>
                                @*<th>Address</th>
                                <th>City</th>
                                <th>State</th>
                                <th>Zip</th>
                                <th>Phone</th>
                                <th>Fax</th>*@
                                <th>@deOROWeb.Resources.Strings.Active</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th hidden="hidden"></th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var m in Model)
                            {
                                <tr>
                                    <td>@m.customername</td>
                                    <td>@m.name</td>
                                    <td>@m.code</td>
                                    <td>@m.email_address</td>
                                    @*<td>@m.address</td>
                                    <td>@m.city</td>
                                    <td>@m.state</td>
                                    <td>@m.zip</td>
                                    <td>@m.phone</td>
                                    <td>@m.fax</td>*@
                                    @if (@m.is_active == 1)
                                    {
                                        <td>@deOROWeb.Resources.Strings.True</td>
                                    }
                                    else
                                    {
                                        <td>@deOROWeb.Resources.Strings.False</td>
                                    }
                                    <td>
                                        <div class="btn-group" role="group">
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-primary btn-flat btn-sm" data-toggle="dropdown">
                                                    @deOROWeb.Resources.Strings.Items
                                                    <span class="caret"></span>
                                                    <span class="sr-only">Toggle Dropdown</span>
                                                </button>

                                                <ul class="dropdown-menu" role="menu">
                                                    <li><a href="#" data-toggle="modal" data-target="#popup-modal-add-remove" id="@m.id-add-remove-items">@deOROWeb.Resources.Strings.Add / @deOROWeb.Resources.Strings.Remove @deOROWeb.Resources.Strings.Items</a></li>
                                                    @*<li><a href="#" data-toggle="modal" data-target="#popup-modal-edit" id="@m.id-edit-items">Edit Items</a></li>*@
                                                    @*<li><a href="#" id="@m.id-edit-items">Edit Items</a></li>*@
                                                    <li><a href="@Request.ApplicationPath/LocationItem/Index/@m.id" id="@m.id-edit-items">@deOROWeb.Resources.Strings.Edit @deOROWeb.Resources.Strings.Items</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-primary btn-flat btn-sm" data-toggle="dropdown">
                                                    @deOROWeb.Resources.Strings.Users
                                                    <span class="caret"></span>
                                                    <span class="sr-only">Toggle Dropdown</span>
                                                </button>
                                                <ul class="dropdown-menu" role="menu">
                                                    <li><a href="@Request.ApplicationPath/User/Index?customerid=@m.customerid&locationid=@m.id&usersshared=@m.users_shared"  id="@m.id-user-list">@deOROWeb.Resources.Strings.UserList</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="btn-group" role="group">
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-primary btn-flat btn-sm" data-toggle="dropdown">
                                                    @deOROWeb.Resources.Strings.Discounts
                                                    <span class="caret"></span>
                                                    <span class="sr-only">Toggle Dropdown</span>
                                                </button>
                                                <ul class="dropdown-menu" role="menu">
                                                    <li><a href="#"  data-toggle="modal" data-target="#popup-modal-combo-discount" data-id="@m.id">@deOROWeb.Resources.Strings.ComboDiscounts</a></li>
                                                    <li><a href="#" data-toggle="modal" data-target="#popup-modal-item-discount" data-id="@m.id">@deOROWeb.Resources.Strings.ItemDiscounts</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </td>
                                    <td>
                                        @*<i class="fa fa-camera"><a class="btn btn-app-small" href="@Request.ApplicationPath/LocationCredit/Index/@m.id">Camera Feed</a></i>*@
                                        <button class="btn btn-primary btn-flat btn-sm" data-toggle="modal" data-target="#popup-modal-subsidies" id="button-subsidies" data-id="@m.id">
                                            <i class="fa fa-money"></i>&nbsp;&nbsp;@deOROWeb.Resources.Strings.Subsidies</button>
                                    </td>
                                    <td>
                                        @*<i class="fa fa-camera"><a class="btn btn-app-small" href="@Request.ApplicationPath/LocationCredit/Index/@m.id">Camera Feed</a></i>*@
                                        <button class="btn btn-primary btn-flat btn-sm" data-toggle="modal" data-target="#popup-modal-camera-feed" id="button-camera-feed" data-id="@m.id">
                                            <i class="fa  fa-camera"></i>&nbsp;&nbsp;@deOROWeb.Resources.Strings.CameraFeed</button>
                                    </td>
                                    <td>
                                        <i class="fa fa-usd"><a class="btn btn-app-small" href="@Request.ApplicationPath/LocationCredit/Index/@m.id">@deOROWeb.Resources.Strings.Credits</a></i>

                                    </td>
                                    <td>
                                        <i class="fa fa-edit"><a class="btn btn-app-small" id="@m.id-planogram">@deOROWeb.Resources.Strings.EditPlanogram</a></i>
                                    </td>
                                    <td>
                                        <i class="fa fa-edit"><a class="btn btn-app-small" data-toggle="modal" data-target="#popup-modal" id="@m.id-edit">@deOROWeb.Resources.Strings.Edit</a></i>
                                    </td>
                                    <td hidden="hidden">
                                        <i class="fa fa-trash-o"><a class="btn btn-app-small" id="@m.id-delete">@deOROWeb.Resources.Strings.Delete</a></i>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
</aside>

<div class="modal fade" id="popup-modal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="modal-title"><i class="fa fa-user"></i>&nbsp;@deOROWeb.Resources.Strings.Location</h4>
            </div>
            <form action="#" method="post" id="form-location">
                <div class="modal-body">
                    <input id="input_hidden_action" type="hidden" />
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.Customer</label>
                        <select class="form-control" id="combo-customer">
                        </select>
                    </div>
                    @*<div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">Customer Name:</span>
                            <input id="input-customer-name" class="form-control" placeholder="Customer Name">
                        </div>
                    </div>*@
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.LocationName <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Name">(?)</a> :</span>
                            <input id="input_location_name" name="input_location_name" class="form-control" placeholder="@deOROWeb.Resources.Strings.LocationName" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.LocationCode <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Custom Code">(?)</a> :</span>
                            <input id="input_location_code" name="input_location_code" class="form-control" placeholder="@deOROWeb.Resources.Strings.LocationCode" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.Active <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top simptip-multiline" data-tooltip="Select 'Yes' to show this Kiosk Location in the system, otherwise select 'No' only to save it.">(?)</a></label>
                        <select class="form-control" id="combo-active">
                            <option value='1' selected="selected">@deOROWeb.Resources.Strings.True</option>
                            <option value='0'>@deOROWeb.Resources.Strings.False</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.UserName <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="deORO Location's Username for Cloud">(?)</a> :</span>
                                    <input id="input_user_name" name="input_user_name" class="form-control" placeholder="User Name" required="required">
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.Password <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="deORO Location's Password for Cloud">(?)</a> :</span>
                                    <input id="input-password" name="input-password" class="form-control" placeholder="Password" type="password" required="required">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.EmailAddress <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Responsible Email">(?)</a> :</span>
                            <input id="input_email_address" name="input_email_address" class="form-control" placeholder="Email Address" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.Address <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Address">(?)</a> :</span>
                            <input id="input-address" name="input-address" class="form-control" placeholder="Address" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.City <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's City">(?)</a> :</span>
                            <input id="input-city" name="input-city" class="form-control" placeholder="City" required="required">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.State <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's State">(?)</a> :</span>
                                    @* //===============================UNITED STATES=========================================================*@
                                    <select name="combo-state" id="combo-state" class="form-control">
                                        <option value="">@deOROWeb.Resources.Strings.SelectOne</option>
                                        <option value="AL">Alabama</option>
                                        <option value="AK">Alaska</option>
                                        <option value="AZ">Arizona</option>
                                        <option value="AR">Arkansas</option>
                                        <option value="CA">California</option>
                                        <option value="CO">Colorado</option>
                                        <option value="CT">Connecticut</option>
                                        <option value="DE">Delaware</option>
                                        <option value="DC">District of Columbia</option>
                                        <option value="FL">Florida</option>
                                        <option value="GA">Georgia</option>
                                        <option value="HI">Hawaii</option>
                                        <option value="ID">Idaho</option>
                                        <option value="IL">Illinois</option>
                                        <option value="IN">Indiana</option>
                                        <option value="IA">Iowa</option>
                                        <option value="KS">Kansas</option>
                                        <option value="KY">Kentucky</option>
                                        <option value="LA">Louisiana</option>
                                        <option value="ME">Maine</option>
                                        <option value="MD">Maryland</option>
                                        <option value="MA">Massachusetts</option>
                                        <option value="MI">Michigan</option>
                                        <option value="MN">Minnesota</option>
                                        <option value="MS">Mississippi</option>
                                        <option value="MO">Missouri</option>
                                        <option value="MT">Montana</option>
                                        <option value="NE">Nebraska</option>
                                        <option value="NV">Nevada</option>
                                        <option value="NH">New Hampshire</option>
                                        <option value="NJ">New Jersey</option>
                                        <option value="NM">New Mexico</option>
                                        <option value="NY">New York</option>
                                        <option value="NC">North Carolina</option>
                                        <option value="ND">North Dakota</option>
                                        <option value="OH">Ohio</option>
                                        <option value="OK">Oklahoma</option>
                                        <option value="OR">Oregon</option>
                                        <option value="PA">Pennsylvania</option>
                                        <option value="RI">Rhode Island</option>
                                        <option value="SC">South Carolina</option>
                                        <option value="SD">South Dakota</option>
                                        <option value="TN">Tennessee</option>
                                        <option value="TX">Texas</option>
                                        <option value="UT">Utah</option>
                                        <option value="VT">Vermont</option>
                                        <option value="VA">Virginia</option>
                                        <option value="WA">Washington</option>
                                        <option value="WV">West Virginia</option>
                                        <option value="WI">Wisconsin</option>
                                        <option value="WY">Wyoming</option>
                                    </select>
                                    @* //===============================MEXICO=========================================================*@
                               @*              <select name="combo-state" id="combo-state" class="form-control">
                                <option value="">Select One</option>
                                <option value="AGU">Aguascalientes</option>
                                <option value="BCN">Baja California</option>
                                <option value="BCS">Baja California Sur</option>
                                <option value="CAM">Campeche</option>
                                <option value="COA">Coahuila de Zaragoza</option>
                                <option value="COL">Colima</option>
                                <option value="CHP">Chiapas</option>
                                <option value="CHH">Chihuahua</option>
                                <option value="CMX">Ciudad de México</option>
                                <option value="DIF">Distrito Federal</option>
                                <option value="DUR">Durango</option>
                                <option value="GUA">Guanajuato</option>
                                <option value="GRO">Guerrero</option>
                                <option value="HID">Hidalgo</option>
                                <option value="JAL">Jalisco</option>
                                <option value="MEX">México</option>
                                <option value="MIC">Michoacán de Ocampo</option>
                                <option value="MOR">Morelos</option>
                                <option value="NAY">Nayarit</option>
                                <option value="NLE">Nuevo León</option>
                                <option value="OAX">Oaxaca</option>
                                <option value="PUE">Puebla</option>
                                <option value="QUE">Querétaro</option>
                                <option value="ROO">Quintana Roo</option>
                                <option value="SLP">San Luis Potosí</option>
                                <option value="SIN">Sinaloa</option>
                                <option value="SON">Sonora</option>
                                <option value="TAB">Tabasco</option>
                                <option value="TAM">Tamaulipas</option>
                                <option value="TLA">Tlaxcala</option>
                                <option value="VER">Veracruz de Ignacio de la Llave</option>
                                <option value="YUC">Yucatán</option>
                                <option value="ZAC">Zacatecas</option>
                            </select>*@


                                </div>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.Zip <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Zip">(?)</a> :</span>
                                    <input id="input-zip" name="input-zip" class="form-control" placeholder="Zip" required="required">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.Phone <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Responsible Phone">(?)</a> :</span>
                                    <input id="input-phone" name="input-phone" class="form-control" placeholder="Phone" required="required">
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.Fax <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Responsible Fax">(?)</a> :</span>
                                    <input id="input-fax" class="form-control" placeholder="Fax">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.DefaultDriver <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Kiosk Location's Item Filler">(?)</a></label>
                        @Html.DropDownListSelected("combo-driver", "", new SelectList(ViewBag.Users, "pkid", "username", 0))
                    </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.LastServiceDate <a style="cursor: pointer; font-weight: normal;" class="simptip-position-top" data-tooltip="Last Kiosk Location's Items Refill">(?)</a> :</span>
                                    <input id="input-last-service-date" class="form-control" placeholder="Last Service Date">
                                </div>
                            </div>
                        </div>

                        <div class="col-xs-6">
                            <div class="form-group">
                                <div class="input-group">
                                    <span class="input-group-addon">@deOROWeb.Resources.Strings.ServiceInterval:</span>
                                    <input id="input-service-interval" class="form-control" placeholder="Service Interval">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" id="button-cancel" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="submit" class="btn btn-primary pull-left" id="button-save"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>


<div class="modal fade" id="popup-modal-add-remove" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title"><i class="fa fa-user"></i>@deOROWeb.Resources.Strings.Add / @deOROWeb.Resources.Strings.Remove @deOROWeb.Resources.Strings.Items</h4>
            </div>
            <form action="#" method="post" id="form-add-remove">
                <div class="modal-body">
                    <input id="input-hidden-locationid" type="hidden" />
                    <input id="input-hidden-customerid" type="hidden" />
                    @*<div class="form-group">
                        <label>Customer</label>
                        @Html.DropDownList("Customers", new SelectList(ViewBag.Customers, "id", "name"), "Select Customer", new { id = "combo-customer-add-remove", @class = "form-control" })
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <select class="form-control" id="combo-location-add-remove" required="required" name="combo-location-add-remove">
                        </select>
                    </div>*@
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.Items</label>
                        <select multiple class="form-control" id="list-item" style="height: 350px">
                        </select>
                    </div>
                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="submit" class="btn btn-primary pull-left" id="button-save-add-remove"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="popup-modal-combo-discount" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title"><i class="fa fa-user"></i>@deOROWeb.Resources.Strings.Add / @deOROWeb.Resources.Strings.Remove @deOROWeb.Resources.Strings.ComboDiscounts</h4>
            </div>
            <form action="#" method="post" id="form-combo-discount">
                <div class="modal-body">
                    <div class="form-group">
                        <label> @deOROWeb.Resources.Strings.ComboDiscounts</label>
                        <select multiple class="form-control" id="list-combo-discount" style="height: 350px">
                        </select>
                    </div>
                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="submit" class="btn btn-primary pull-left" id="button-save-combo-discounts"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="popup-modal-subsidies" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title"><i class="fa fa-money"></i>@deOROWeb.Resources.Strings.Add / @deOROWeb.Resources.Strings.Remove @deOROWeb.Resources.Strings.Subsidies</h4>
            </div>
            <form action="#" method="post" id="form-subsidies">
                <div class="modal-body">
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.Subsidies</label>
                        <select multiple class="form-control" id="list-subsidies" style="height: 350px">
                        </select>
                    </div>
                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="submit" class="btn btn-primary pull-left" id="button-save-subsidies"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="popup-modal-camera-feed" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title"><i class="fa fa-user"></i>@deOROWeb.Resources.Strings.CameraFeed</h4>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label>@deOROWeb.Resources.Strings.Camera</label>
                    <select class="form-control" id="combo-camera">
                    </select>
                </div>
                <div class="row">
                    <div class="col-xs-4">
                        <div class="form-group">
                            <div class="input-group">
                                <span class="input-group-addon">@deOROWeb.Resources.Strings.Date:</span>
                                <input id="input-camera-date" class="form-control" placeholder="From Date">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-4">
                        <div class="form-group">
                            <div class="input-group">
                                <span class="input-group-addon">@deOROWeb.Resources.Strings.FromTime:</span>
                                <input id="input-from-time" class="form-control" placeholder="From Time">
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-4">
                        <div class="form-group">
                            <div class="input-group">
                                <span class="input-group-addon">@deOROWeb.Resources.Strings.ToTime:</span>
                                <input id="input-to-time" class="form-control" placeholder="To Time">
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="modal-footer clearfix">
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                <button type="button" class="btn btn-primary pull-left" id="button-show-feed"><i class="fa fa-camera"></i>@deOROWeb.Resources.Strings.ShowFeed</button>
            </div>
            <div id="jp_container_N" class="jp-video jp-video-270p" role="application" aria-label="media player">
                <div class="jp-type-playlist">
                    <div id="jquery_jplayer_N" class="jp-jplayer"></div>
                    <div class="jp-gui">
                        <div class="jp-video-play">
                            <button class="jp-video-play-icon" role="button" tabindex="0">@deOROWeb.Resources.Strings.play</button>
                        </div>
                        <div class="jp-interface">
                            <div class="jp-progress">
                                <div class="jp-seek-bar">
                                    <div class="jp-play-bar"></div>
                                </div>
                            </div>
                            <div class="jp-current-time" role="timer" aria-label="time">&nbsp;</div>
                            <div class="jp-duration" role="timer" aria-label="duration">&nbsp;</div>
                            <div class="jp-controls-holder">
                                <div class="jp-controls">
                                    <button class="jp-previous" role="button" tabindex="0">previous</button>
                                    <button class="jp-play" role="button" tabindex="0">@deOROWeb.Resources.Strings.play</button>
                                    <button class="jp-next" role="button" tabindex="0">@deOROWeb.Resources.Strings.Next</button>
                                    <button class="jp-stop" role="button" tabindex="0">@deOROWeb.Resources.Strings.stop</button>
                                </div>
                                <div class="jp-volume-controls">
                                    <button class="jp-mute" role="button" tabindex="0">@deOROWeb.Resources.Strings.mute</button>
                                    <button class="jp-volume-max" role="button" tabindex="0">@deOROWeb.Resources.Strings.maxvolume</button>
                                    <div class="jp-volume-bar">
                                        <div class="jp-volume-bar-value"></div>
                                    </div>
                                </div>
                                <div class="jp-toggles">
                                    <button class="jp-repeat" role="button" tabindex="0">@deOROWeb.Resources.Strings.repeat</button>
                                    <button class="jp-shuffle" role="button" tabindex="0">@deOROWeb.Resources.Strings.shuffle</button>
                                    <button class="jp-full-screen" role="button" tabindex="0">@deOROWeb.Resources.Strings.fullscreen</button>
                                </div>
                            </div>
                            <div class="jp-details">
                                <div class="jp-title" aria-label="title">&nbsp;</div>
                            </div>
                        </div>
                    </div>
                    <div class="jp-playlist" style="overflow-y: auto; height: 250px">
                        <ul>
                            <!-- The method Playlist.displayPlaylist() uses this unordered list -->
                            <li>&nbsp;</li>
                        </ul>
                    </div>
                    <div class="jp-no-solution">
                        <span>Update Required</span>
                        To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="popup-modal-item-discount" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title"><i class="fa fa-user"></i> @deOROWeb.Resources.Strings.Add /  @deOROWeb.Resources.Strings.Remove  @deOROWeb.Resources.Strings.ItemDiscounts</h4>
            </div>
            <form action="#" method="post" id="form-item-discount">
                <div class="modal-body">
                    <div class="form-group">
                        <label> @deOROWeb.Resources.Strings.Discounts</label>
                        <select class="form-control" onchange="RefreshDiscountedItems()" id="combo-discount">
                        </select>
                    </div>
                    <div class="form-group">
                        <label>@deOROWeb.Resources.Strings.Items</label>
                        <select multiple class="form-control" id="list-item-discount" style="height: 200px">
                        </select>
                    </div>
                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="submit" class="btn btn-primary pull-left" id="button-save-item-discounts"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="popup-modal-user-add" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                @*  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>*@
                <h4 class="modal-title"><i class="fa fa-user"></i>&nbsp;@deOROWeb.Resources.Strings.NewUserRegistration</h4>
            </div>
            <form action="#" method="post" id="form-user-add">
                <div class="modal-body">
                    @* <input id="input_hidden_action" type="hidden" />*@
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.FirstName:</span>
                            <input id="input_user_first_name" name="input_user_first_name" class="form-control" placeholder="User First Name" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.LastName:</span>
                            <input id="input_user_last_name" name="input_user_last_name" class="form-control" placeholder="User Last Name" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.EmailAddress:</span>
                            <input id="input_user_email_address" name="input_user_email_address" class="form-control" placeholder="User Email Address" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.LoginUserName:</span>
                            <input id="input_user_username" name="input_user_username" class="form-control" placeholder="Username" required="required">
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.Password:</span>
                            <input id="input_user_password" name="input_user_password" type="password" class="form-control" placeholder="User Password" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.ConfirmPassword:</span>
                            <input id="input_user_confirm_password" name="input_user_confirm_password" type="password" class="form-control" placeholder="User Password Confirmation" required="required">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="input-group">
                            <span class="input-group-addon">@deOROWeb.Resources.Strings.UserBarcode:</span>
                            <input id="input_user_barcode" name="input_user_barcode" class="form-control" placeholder="User Barcode" required="required">
                        </div>
                    </div>


                </div>
                <div class="modal-footer clearfix">
                    <button type="button" class="btn btn-danger" id="button-cancel-user" data-dismiss="modal"><i class="fa fa-times"></i>@deOROWeb.Resources.Strings.Cancel</button>
                    <button type="button" class="btn btn-primary pull-left" id="button-save-user"><i class="fa fa-save"></i>@deOROWeb.Resources.Strings.Save</button>
                </div>
            </form>
        </div>
    </div>
</div>

<style type="text/css" id="custom-modal">
    .modal-lg {
        width: 1200px!important;
        margin: 0 auto;
    }
</style>

<script>




    //==================================ADD NEW USER FOR THE MACHINE========================================

    var LastUserID = null;
    var NewUserProcess = false;
    var NewUserLocationID = null;


    $('#combo-driver').append('<option value="-2" >=====ADD NEW DRIVER=====</option>');

    $("select[name='combo-driver']").change(function () {
        var sel_opt = $(this).val();
        //alert(sel_opt);
        if (sel_opt == -2) {
            NewUserLocationID = $("#input_hidden_action").val();
            $("#popup-modal").modal("hide");
            $("#popup-modal-user-add").modal("show");
        }
    });

    $('#button-save-user').click(function () {
        if (!$("#form-user-add").valid()) return;

        @*        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/User/GetLastUser",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $.each(result, function (i, val) {
                    LastUserID = val.id + 1;
                    $("select[name='combo-driver'] option:contains('=====ADD NEW DRIVER=====')").val(LastUserID);
                    $("select[name='combo-driver'] option:contains('=====ADD NEW DRIVER=====')").text($("#input_user_username").val());
                    NewUserProcess = true;
                    $("#popup-modal-user-add").modal("hide");
                    $("#popup-modal").modal("show");
                    $('#combo-driver').val(LastUserID);

                });
            },
            error: function (error) {
                //alert("There was an error getting the data from the server: " + error.responseText);
            }
        })*@

        LastUserID = -3;
        $("select[name='combo-driver'] option:contains('=====ADD NEW DRIVER=====')").val(LastUserID);
        $("select[name='combo-driver'] option:contains('=====ADD NEW DRIVER=====')").text($("#input_user_username").val());
        NewUserProcess = true;
        $("#popup-modal-user-add").modal("hide");
        $("#popup-modal").modal("show");
        $('#combo-driver').val(LastUserID);


    })

    $('#button-cancel-user').click(function () {
        $('#form-user-add').val('').prop('readonly', false);
        $('#combo-driver').val('0');
        LastUserID = null;
        NewUserProcess = true;
        $("#popup-modal-user-add").modal("hide");
        $("#popup-modal").modal("show");

    })


    $('#button-cancel').click(function () {

        if (LastUserID != null) {
            $("select[name='combo-driver'] option:contains('" + $("#input_user_username").val() + "')").val(-2);
            $("select[name='combo-driver'] option:contains('" + $("#input_user_username").val() + "')").text('=====ADD NEW DRIVER=====');
        }

        LastUserID = null;
        NewUserProcess = false;
    })

    //======================================================================




    //$('#input-camera-from-date').val(new Date().getMonth() + 1 + '/1/' + new Date().getFullYear() + ' ' + new Date().getHours() + ":" + new Date().getMinutes());
    //$('#input-camera-to-date').val(new Date().getMonth() + 1 + '/1/' + new Date().getFullYear()  + ' ' + new Date().getHours() + ":" + new Date().getMinutes());

    //$('#input-camera-date').val("02/06/2016");
    $('#input-camera-date').val(new Date().getMonth() + 1 + '/' + new Date().getDate() + '/' + new Date().getFullYear());
    $('#input-from-time').val('00:00');
    $('#input-to-time').val('23:59');

    $('#input-camera-date').datetimepicker({
        timepicker: false, format: 'm/d/Y'
    });

    $('#input-from-time').datetimepicker({
        datepicker: false,
        format: 'H:i'
    });

    $('#input-to-time').datetimepicker({
        datepicker: false,
        format: 'H:i'
    });


    $('#input-last-service-date').datetimepicker({
        timepicker: false, format: 'm/d/Y'
    });



    var locationid;
    var myPlaylist;

    $('#popup-modal-camera-feed').on('show.bs.modal', function (e) {

        $('.jp-playlist').hide();

        locationid = $(e.relatedTarget).data('id');

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Location/GetCameras/" + locationid,
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $('#combo-camera').empty();
                $.each(result, function (i, val) {
                    $('#combo-camera').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
            }
        })

        myPlaylist = new jPlayerPlaylist({
            jPlayer: "#jquery_jplayer_N",
            cssSelectorAncestor: "#jp_container_N"
        }, [], {
            playlistOptions: {
                enableRemoveControls: true
            },
            size: {
                width: "596px",
            },
            swfPath: "../../dist/jplayer",
            supplied: "webmv, ogv, m4v, oga, mp3, m4v",
            solutions: "flash, html",
            useStateClassSkin: true,
            autoBlur: false,
            smoothPlayBar: true,
            keyEnabled: true,
            audioFullScreen: true,
        });

    }).on('hidden.bs.modal', function () {
        myPlaylist.remove();
        $('.jp-playlist').hide();
    });

    $('#combo-camera').change(function (e) {
        myPlaylist.remove();
    });


    $('#button-show-feed').click(function (e) {

        myPlaylist.remove();

        var postData = JSON.stringify({
            'locationid': locationid,
            'camera': $('#combo-camera  option:selected').text(),
            'feedPath': $('#combo-camera  option:selected').val(),
            'cameraDate': $('#input-camera-date').val(),
            'fromTime': $('#input-from-time').val(),
            'toTime': $('#input-to-time').val()
        });

        $.ajax({
            cache: false,
            type: "POST",
            url: "@Request.ApplicationPath/Location/GetCameraFeed/",
            dataType: "json",
            async: false,
            data: postData,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $('.jp-playlist').show();

                if (result.length <= 0) {
                    $('.jp-playlist').css("height", "50px");
                    myPlaylist.add({
                        title: 'No Video Found',
                    });
                }
                else {
                    $('.jp-playlist').css("height", "200px");
                    $.each(result, function (i, val) {
                        myPlaylist.add({
                            title: '@Request.ApplicationPath/CameraFeed/' + val,
                            free: true,
                            m4v: '@Request.ApplicationPath/CameraFeed/' + val,
                        });

                    });
                }
            },
            error: function (error) {
            }
        })


    });

    $('#popup-modal-item-discount').on('show.bs.modal', function (e) {

        locationid = $(e.relatedTarget).data('id');

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Discount/GetDiscounts",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (result) {
                $('#combo-discount').empty();
                $.each(result, function (i, val) {
                    $('#combo-discount').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
            }
        })

        loadDiscountedItems($('#combo-discount').val());
    });

    function loadDiscountedItems(discountid) {

        var postData = JSON.stringify({
            'locationid': locationid,
            'discountid': discountid,
        });

        $('#list-item-discount').bootstrapDualListbox({
            preserveSelectionOnMove: 'moved',
            moveOnSelect: false,
        });

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/LocationItem/GetItems/" + locationid,
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $('#list-item-discount').empty();
                $.each(result, function (i, val) {
                    $('#list-item-discount').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
            }
        })

        $.ajax({
            cache: false,
            type: "POST",
            url: "@Request.ApplicationPath/LocationItem/GetDiscountedItems/",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: postData,
            async: false,
            success: function (result) {
                $.each(result, function (i, val) {
                    $("#list-item-discount > option").each(function () {
                        if (val.id == this.value) {
                            $("#list-item-discount > [value='" + this.value + "']").attr("selected", "true");
                        }
                    });
                });
            },
            error: function (error) {
            }
        })

        $('#list-item-discount').bootstrapDualListbox('refresh');
    }


    function RefreshDiscountedItems() {
        loadDiscountedItems($('#combo-discount').val());
    }


    $('#button-save-subsidies').click(function () {

        var postData = JSON.stringify({
            'locationid': locationid,
            'ids': $('#list-subsidies').val()
        });

        $.ajax({
            type: "POST",
            url: "@Request.ApplicationPath/LocationSubsidy/AddRemoveSubsidies",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: postData,
            async: false,
            success: function (result) {
            },
            error: function (error) {
            }
        });
    })

    $('#popup-modal-subsidies').on('show.bs.modal', function (e) {

        locationid = $(e.relatedTarget).data('id');

        $('#list-subsidies').bootstrapDualListbox({
            preserveSelectionOnMove: 'moved',
            moveOnSelect: false,
        });

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Subsidy/GetSubsidies",
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $('#list-subsidies').empty();
                $.each(result, function (i, val) {
                    $('#list-subsidies').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
            }
        })

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/LocationSubsidy/GetLocationSubsidies/" + locationid,
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {

                $.each(result, function (i, val) {

                    $("#list-subsidies > option").each(function () {
                        if (val.id == this.value) {
                            $("#list-subsidies > [value='" + this.value + "']").attr("selected", "true");
                        }
                    });
                });
            },
            error: function (error) {
            }
        })

        $('#list-subsidies').bootstrapDualListbox('refresh');

    });


    $('#popup-modal-combo-discount').on('show.bs.modal', function (e) {

        locationid = $(e.relatedTarget).data('id');

        $('#list-combo-discount').bootstrapDualListbox({
            preserveSelectionOnMove: 'moved',
            moveOnSelect: false,
        });

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/ComboDiscount/GetComboDiscounts",
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                $('#list-combo-discount').empty();
                $.each(result, function (i, val) {
                    $('#list-combo-discount').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
            }
        })


        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/LocationComboDiscount/GetLocationComboDiscounts/" + locationid,
            dataType: "json",
            async: false,
            contentType: "application/json; charset=utf-8",
            success: function (result) {

                $.each(result, function (i, val) {

                    $("#list-combo-discount > option").each(function () {
                        if (val.id == this.value) {
                            $("#list-combo-discount > [value='" + this.value + "']").attr("selected", "true");
                        }
                    });
                });
            },
            error: function (error) {
            }
        })


        $('#list-combo-discount').bootstrapDualListbox('refresh');

    })

    $('#button-save-item-discounts').click(function () {

        var postData = JSON.stringify({
            'locationid': locationid,
            'discountid': $('#combo-discount').val(),
            'itemids': $('#list-item-discount').val()
        });

        $.ajax({
            type: "POST",
            url: "@Request.ApplicationPath/LocationItem/UpdateDiscount",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: postData,
            async: false,
            success: function (result) {
            },
            error: function (error) {
            }
        });
    })


    $('#button-save-combo-discounts').click(function () {

        var postData = JSON.stringify({
            'locationid': locationid,
            'ids': $('#list-combo-discount').val()
        });

        $.ajax({
            type: "POST",
            url: "@Request.ApplicationPath/LocationComboDiscount/AddRemoveDiscounts",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: postData,
            async: false,
            success: function (result) {
            },
            error: function (error) {
            }
        });
    })

    $('#popup-modal').on('show.bs.modal', function (e) {

        if (NewUserProcess == false) {
            $.ajax({
                cache: false,
                type: "GET",
                url: "@Request.ApplicationPath/Customer/GetCustomers",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (result) {
                    $('#combo-customer').empty();
                    $.each(result, function (i, val) {
                        $('#combo-customer').append(new Option(val.name, val.id));
                    });
                },
                error: function (error) {
                    //alert("There was an error getting the data from the server: " + error.responseText);
                }
            })

            $('.form-control').val('').prop('readonly', false);
            $("#form-location").validate().resetForm();
            $(".form-group").removeClass("has-error");
            $(".input").prop('readonly', false);
            $('#combo-active').val('1');
            $('#combo-driver').val('0');
            $('#combo-state').val('');
        }

    })


    $.validator.setDefaults({
        highlight: function (element) {
            $(element).closest('.form-group').addClass('has-error');
        },
        unhighlight: function (element) {
            $(element).closest('.form-group').removeClass('has-error');
        },
        errorElement: 'span',
        errorClass: 'help-block',
        errorPlacement: function (error, element) {
            if (element.parent('.input-group').length) {
                error.insertAfter(element.parent());
            } else {
                error.insertAfter(element);
            }
        }
    });


    $('#form-location').validate({
        onkeyup: false,
        rules: {
            "input_location_name": {
                required: true,
                remote: {
                    url: "@Request.ApplicationPath/Location/IsNameAvailable/",
                    type: "post",
                    data: {
                        input_hidden_action: function () {
                            return $('#input_hidden_action').val();
                        }
                    }

                }
            },
            "input_location_code": {
                required: true,
                remote: {
                    url: "@Request.ApplicationPath/Location/IsCodeAvailable/",
                    type: "post",
                    data: {
                        input_hidden_action: function () {
                            return $('#input_hidden_action').val();
                        }
                    }

                }
            },
            "input_user_name": {
                required: true,
                remote: {
                    url: "@Request.ApplicationPath/Location/IsUsernameAvailable/",
                    type: "post",
                    data: {
                        input_hidden_action: function () {
                            return $('#input_hidden_action').val();
                        }
                    }

                }
            },
            "input-password": {
                required: true
            },
            "input_email_address": {
                required: true,
                minlength: 6,
                email: true,
                remote: {
                    url: "@Request.ApplicationPath/Location/IsEmailAvailable/",
                    type: "post",
                    data: {
                        input_hidden_action: function () {
                            return $('#input_hidden_action').val();
                        }
                    }

                }
            },
            "input-address": {
                required: false
            },
            "input-city": {
                required: false
            },
            "input-state": {
                required: false
            },
            "input-zip": {
                required: false
            },
            "input-phone": {
                required: false
            }
        },
        messages: {
            "input_user_name": {
                remote: "User Name already in use"
            },
            "input_email_address": {
                remote: "Email Address already in use"
            },
            "input_location_code": {
                remote: "Location Code already in use"
            },
            "input_location_name": {
                remote: "Location Name already in use"
            }
        }
    });

    $('#form-add-remove').validate();

    $('#popup-modal-add-remove').on('show.bs.modal', function (e) {

        $('#list-item').bootstrapDualListbox({
            preserveSelectionOnMove: 'moved',
            moveOnSelect: false,
        });

        $("#form-add-remove").validate().resetForm();
        $(".form-group").removeClass("has-error");
    })


    $('#form-user-add').validate({
        onkeyup: false,
        rules: {
            "input_user_first_name": {
                required: true
            },
            "input_user_last_name": {
                required: true
            },
            "input_user_email_address": {
                required: true,
                minlength: 6,
                email: true
            },
            "input_user_username": {
                required: true,
                remote: {
                    url: "@Request.ApplicationPath/Location/IsLoginUsernameAvailable/",
                             type: "post",
                             data: {
                                 input_hidden_action: function () {
                                     //return $('#input_hidden_action').val();
                                 }
                             }

                         }
            },
            "input_user_password": {
                required: true
            },
            "input_user_confirm_password": {
                required: true,
                equalTo: "#input_user_password"
            },
            "input_user_barcode": {
                required: false
            }
        },
        messages: {
            "input_user_username": {
                remote: "User Name already in use"
            },
            "input_user_confirm_password": {
                remote: "These passwords don't match. Try Again?"
            }
        }
    });

$('#form-add-remove').validate();

$('#popup-modal-add-remove').on('show.bs.modal', function (e) {

    $('#list-item').bootstrapDualListbox({
        preserveSelectionOnMove: 'moved',
        moveOnSelect: false,
    });

    $("#form-add-remove").validate().resetForm();
    $(".form-group").removeClass("has-error");
})






//$('#popup-modal-edit').on('show.bs.modal', function (e) {
//    $('#combo-customer-edit').val('');
//    $('#combo-location-edit').empty();
//    $('#location-items').empty();
//})

//$('#').change(function () {
//    LoadLocations();combo-customer-add-remove
//});

    @* $('#combo-customer-edit').change(function () {

        $('#location-items').empty();

        var id = $('#combo-customer-edit  option:selected').val();

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Location/GetLocations/" + id,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (result) {
                $('#combo-location-edit').empty();
                $.each(result, function (i, val) {
                    $('#combo-location-edit').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
                //alert("There was an error getting the data from the server: " + error.responseText);
            }

        })

        LoadItemsWithDetails();
    });*@

    //$('#combo-location-add-remove').change(function () {
    //    LoadItems();
    //});

    //$('#combo-location-edit').change(function () {
    //    LoadItemsWithDetails();
    //});

    @*function LoadLocations() {

        //$('#combo-location-add-remove').empty();
        //$('#combo-location-add-remove').append($("<option></option>").attr("value", "").text("Loading Locations..."));
        //$('#combo-location-add-remove').prop("disabled", true);

        var id = $('#combo-customer-add-remove  option:selected').val();

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Location/GetLocations/" + id,
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (result) {
                $('#combo-location-add-remove').empty();
                $.each(result, function (i, val) {
                    $('#combo-location-add-remove').append(new Option(val.name, val.id));
                });

                //$('#combo-location').prop("disabled", false);
            },
            error: function (error) {
                alert("There was an error getting the data from the server: " + error.responseText);
            }

        })

        LoadItems();
    }*@

   @* function LoadItemsWithDetails() {

        var id = $('#combo-location-edit  option:selected').val();

        if (id != null) {

            $.ajax({
                cache: false,
                type: "GET",
                url: "@Request.ApplicationPath/LocationItem/GetLocationItems/" + id,
                contentType: "application/json; charset=utf-8",
                dataType: "text",
                async: true,
                success: function (result) {
                    $('#location-items').html(result);
                },
                error: function (error) {
                }
            })
        }
    }*@

    function LoadItems(id) {

        $('#list-item').empty();
        $('#list-item').bootstrapDualListbox('refresh');

        $.ajax({
            cache: false,
            type: "GET",
            url: "@Request.ApplicationPath/Item/GetItems",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (result) {

                $('#list-item').empty();
                $('#list-item').val(0)

                $.each(result, function (i, val) {
                    $('#list-item').append(new Option(val.name, val.id));
                });
            },
            error: function (error) {
                //alert("There was an error getting the data from the server: " + error.responseText);
            }
        })

        if (id != null) {
            $.ajax({
                cache: false,
                type: "GET",
                url: "@Request.ApplicationPath/LocationItem/GetItems/" + id,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                success: function (result) {

                    if (result != null) {
                        $.each(result, function (i, val) {

                            $("#list-item > option").each(function () {
                                if (val.id == this.value) {
                                    $("#list-item > [value='" + this.value + "']").attr("selected", "true");
                                }
                            });
                        });
                    }
                },
                error: function (error) {
                    //alert("There was an error getting the data from the server: " + error.responseText);
                }
            })

            $('#list-item').bootstrapDualListbox('refresh');
        }
        else {
            $('#list-item').empty();
            $('#list-item').bootstrapDualListbox('refresh');
        }
    }

    $('#button-add').click(function (event) {
        $("#input_hidden_action").val('');
    });


    $('a[href="#"]').click(function () {

        var target = event.target.id;

        if (target.indexOf('add-remove-items') >= 0) {

            $("#input-hidden-locationid").val(0);

            var id = target.substring(0, target.indexOf('add-remove-items') - 1);
            LoadItems(id);

            $('#input-hidden-locationid').val(id);
        }
    });

    //$('.btn').click(function (event) {
    $('#grid tbody').on('click', 'tr', function (event) {

        var target = event.target.id;

        if (target.indexOf('planogram') >= 0) {

            var id = target.substring(0, target.indexOf('planogram') - 1);
            //window.location.href = '@Request.ApplicationPath/Planogram/GetItems/' + id
            window.location.href = '@Request.ApplicationPath/Planogram/Index/' + id
            return false;
        }

        else if (target.indexOf('edit') >= 0) {

            var id = target.substring(0, target.indexOf('edit') - 1);
            var postData = '{"id":' + id + '}';

            $("#input_hidden_action").val(id);

            $.ajax({
                type: "POST",
                url: "@Request.ApplicationPath/Location/Details/",
                dataType: "json",
                cache: false,
                contentType: "application/json; charset=utf-8",
                data: postData,
                success: function (result) {
                    $("#combo-customer > [value='" + result.customerid + "']").attr("selected", "true");
                    $('#input_location_name').val(result.name);
                    //$('#input_location_code').val(result.code).prop('readonly', true);
                    $('#input_location_code').val(result.code);
                    $('#input_email_address').val(result.email_address);
                    $('#input-address').val(result.address);
                    $('#input-city').val(result.city);
                    $("#combo-state > [value='" + result.state + "']").attr("selected", "true");
                    $('#input-zip').val(result.zip);
                    $('#input-phone').val(result.phone);
                    $('#input-fax').val(result.fax);
                    $('#input_user_name').val(result.username).prop('readonly', true);
                    $('#input-password').val(result.password);
                    $("#combo-active > [value='" + result.is_active + "']").attr("selected", "true");
                    $("#combo-driver > [value='" + result.driverid + "']").attr("selected", "true");
                    $('#input-service-interval').val(result.service_interval);
                    $('#input-last-service-date').val(ToJavaScriptDate(result.last_service_date_time));

                },
                error: function (error) {
                    //alert("There was an error posting the data to the server: " + error.responseText);
                }
            });
        }
        else if (target.indexOf('delete') >= 0) {

            bootbox.confirm("Are you sure you want to delete this Location?", function (result) {

                if (result) {
                    var id = target.substring(0, target.indexOf('delete') - 1);
                    var postData = '{"id":' + id + '}';

                    $.ajax({
                        type: "POST",
                        url: "@Request.ApplicationPath~/Location/Delete/",
                        dataType: "json",
                        cache: false,
                        contentType: "application/json; charset=utf-8",
                        data: postData,
                        success: function (result) {
                        },
                        error: function (error) {
                            //alert("There was an error posting the data to the server: " + error.responseText);
                        }
                    });
                }
            });
        }
    })



$('#button-save-add-remove').click(function () {

    if (!$("#form-add-remove").valid()) return;

    //var postData = JSON.stringify($('#list-item').val());

    var postData = JSON.stringify({
        'locationid': $("#input-hidden-locationid").val(),
        'itemids': $('#list-item').val()
    });

    $.ajax({
        type: "POST",
        url: "@Request.ApplicationPath/LocationItem/AddRemoveItems",
        dataType: "json",
        contentType: "application/json; charset=utf-8",
        data: postData,
        async: false,
        success: function (result) {
        },
        error: function (error) {
        }
    });
})


$('#button-save').click(function () {

    if (!$("#form-location").valid()) return;

    var hidden = $("#input_hidden_action").val();

    var LocationID = null;

    if (NewUserProcess == false) {
        LocationID = hidden;
    } else {
        LocationID = NewUserLocationID;
    }

    var postData_Location = {
        'id': LocationID,
        'customerid': $('#combo-customer  option:selected').val(),
        'name': $('#input_location_name').val(),
        'code': $('#input_location_code').val(),
        'email_address': $('#input_email_address').val(),
        'address': $('#input-address').val(),
        'city': $('#input-city').val(),
        'state': $('#combo-state  option:selected').val(),
        'zip': $('#input-zip').val(),
        'phone': $('#input-phone').val(),
        'fax': $('#input-fax').val(),
        'is_active': $('#combo-active  option:selected').val(),
        'username': $('#input_user_name').val(),
        'password': $('#input-password').val(),
        'driverid': $('#combo-driver  option:selected').val(),
        'service_interval': $('#input-service-interval').val(),
        'last_service_date_time': $('#input-last-service-date').val()
    };


    var postData_Users;

    if (LastUserID != null) {
        postData_Users = {
            'customerid': $('#combo-customer  option:selected').val(),
            'locationid': 0,
            'first_name': $('#input_user_first_name').val(),
            'last_name': $('#input_user_last_name').val(),
            'email': $('#input_user_email_address').val(),
            'username': $('#input_user_username').val(),
            'password': $('#input_user_password').val(),
            'barcode': $('#input_user_barcode').val(),
            'is_staff': 1,
            'is_active': 1,
            'is_superuser': 1,
            'is_approved': 1,
            'created_date_time': new Date(),
            'last_updated_on': new Date(),
            'applicationname': '',
            'account_balance': 0.00,
            'lastaccountbalancechangeddescription': ''
        };
    } else {
        postData_Users = null;
    }

    if (hidden.length > 0) { //Edit

        $.ajax({
            type: "POST",
            url: "@Request.ApplicationPath/Location/Edit",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({ location_Data: postData_Location, user_Data: postData_Users }),
            async: false,
            success: function (result) {
            },
            error: function (error) {
                //alert("There was an error posting the data to the server: " + error.responseText);
            }
        });
    } else { // Add

        $.ajax({
            type: "POST",
            url: "@Request.ApplicationPath/Location/Create",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({ location_Data: postData_Location, user_Data: postData_Users }),
            async: false,
            success: function (result) {
            },
            error: function (error) {
                //alert("There was an error posting the data to the server: " + error.responseText);
            }
        });
    }

    if (NewUserProcess = true) {
        $("select[name='combo-driver'] option:contains('" + $("#input_user_username").val() + "')").val(-2);
        $("select[name='combo-driver'] option:contains('" + $("#input_user_username").val() + "')").text('=====ADD NEW DRIVER=====');
    }

    NewUserProcess = false;
    LastUserID = null;
});



//=====POSITION CHANGE OF CONVERTION OF TABLE TO JQUERY DATA TABLE AFTER ADD ALL PROPERTIES TO THE CONTROLS TO AVOID ISSUES. By Luis Ruiz

    $('#grid').dataTable({
        "language": {
            "lengthMenu": "@deOROWeb.Resources.Strings.Display _MENU_ @deOROWeb.Resources.Strings.Recordsperpage",
            "zeroRecords": "@deOROWeb.Resources.Strings.Nothingfound - @deOROWeb.Resources.Strings.Sorry",
            "info": "@deOROWeb.Resources.Strings.Showingpage _PAGE_ @deOROWeb.Resources.Strings.of _PAGES_",
            "infoEmpty": "@deOROWeb.Resources.Strings.Norecordsavailable",
            "infoFiltered": "(@deOROWeb.Resources.Strings.filteredfrom _MAX_ @deOROWeb.Resources.Strings.totalrecords)",
            "sSearch": "@deOROWeb.Resources.Strings.Search:",
            "oPaginate": {
                "sFirst": "@deOROWeb.Resources.Strings.First",
                "sLast": "@deOROWeb.Resources.Strings.Last",
                "sNext": "@deOROWeb.Resources.Strings.Next",
                "sPrevious": "@deOROWeb.Resources.Strings.Previous"
            },
        }
});


</script>

