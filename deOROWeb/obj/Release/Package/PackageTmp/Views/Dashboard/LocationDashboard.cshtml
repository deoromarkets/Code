@model deORODataAccess.DTO.LocationDashboardDTO


<div class="row">
    <div class="col-lg-4">
        <div class="small-box bg-aqua">
            <div class="inner">
                @if (Model.last30Top5.Count > 0)
                {
                    <h3>#@Model.last30Top5[0].totalSaleCount ($@Model.last30Top5[0].totalSaleAmount)</h3>
                }
                else
                {
                    <h3>0</h3>
                }
                <p>@deOROWeb.Resources.Strings.Last30DaysSales</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="small-box bg-green">
            <div class="inner">
                @if (Model.last7Top5.Count > 0)
                {
                    <h3>#@Model.last7Top5[0].totalSaleCount ($@Model.last7Top5[0].totalSaleAmount)</h3>
                }
                else
                {
                    <h3>0</h3>
                }
                <p>@deOROWeb.Resources.Strings.Last7DaysSales</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="small-box bg-red">
            <div class="inner">
                @if (Model.dateRangeTop5.Count > 0)
                {
                    <h3>#@Model.dateRangeTop5[0].totalSaleCount ($@Model.dateRangeTop5[0].totalSaleAmount)</h3>
                }
                else
                {
                    <h3>0</h3>
                }
                <p>@deOROWeb.Resources.Strings.DateRangeSales</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.Last30DaysTop5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int i = 1;}
                        @foreach (var m in Model.last30Top5)
                        {
                            <tr>
                                <td>@i.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-blue">@m.count</span></td>
                                <td><span class="badge bg-blue">$@m.amount</span></td>
                            </tr>
                            
                            i++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.Last7DaysTop5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int j = 1;}
                        @foreach (var m in Model.last7Top5)
                        {
                            <tr>
                                <td>@j.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-green">@m.count</span></td>
                                <td><span class="badge bg-green">$@m.amount</span></td>
                            </tr>
                            
                            j++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.DateRangeTop5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int k = 1;}
                        @foreach (var m in Model.dateRangeTop5)
                        {
                            <tr>
                                <td>@k.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-red">@m.count</span></td>
                                <td><span class="badge bg-red">$@m.amount</span></td>
                            </tr>
                            
                            k++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.Last30DaysBottom5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int q = 1;}
                        @foreach (var m in Model.last30Bottom5)
                        {
                            <tr>
                                <td>@q.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-blue">@m.count</span></td>
                                <td><span class="badge bg-blue">$@m.amount</span></td>
                            </tr>
                            
                            q++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.Last7DaysBottom5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int w = 1;}
                        @foreach (var m in Model.last7Bottom5)
                        {
                            <tr>
                                <td>@w.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-yellow">@m.count</span></td>
                                <td><span class="badge bg-yellow">$@m.amount</span></td>
                            </tr>
                            
                            w++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.DateRangeBottom5Sellers</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.ItemName</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                            <th>@deOROWeb.Resources.Strings.Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int e = 1;}
                        @foreach (var m in Model.dateRangeBottom5)
                        {
                            <tr>
                                <td>@e.</td>
                                <td>@m.itemname</td>
                                <td><span class="badge bg-red">@m.count</span></td>
                                <td><span class="badge bg-red">$@m.amount</span></td>
                            </tr>
                            
                            e++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6">
        <div class="small-box bg-aqua">
            <div class="inner">
                @if (Model.deviceErrors.Count > 0)
                {
                    <h3>@Model.deviceErrors.Sum(x => x.count)</h3>
                }
                else
                {
                    <h3>0</h3>
                }
                <p>@deOROWeb.Resources.Strings.DeviceErrors</p>
            </div>
            <div class="icon">
                <i class="ion ion-alert-circled"></i>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="small-box bg-yellow">
            <div class="inner">
                @if (Model.transactionErrors.Count > 0)
                {
                    <h3>@Model.transactionErrors.Sum(x => x.count)</h3>
                }
                else
                {
                    <h3>0</h3>
                }
                <p>@deOROWeb.Resources.Strings.TransactionErrors</p>
            </div>
            <div class="icon">
                <i class="ion ion-alert-circled"></i>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-lg-6">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.DeviceErrors</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.Source</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int t = 1;}
                        @foreach (var m in Model.deviceErrors)
                        {
                            <tr>
                                <td>@t.</td>
                                <td>@m.source</td>
                                <td><span class="badge bg-blue">@m.count</span></td>
                            </tr>
                            
                            
                            t++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="box">
            <div class="box-header with-border">
                <h3 class="box-title">@deOROWeb.Resources.Strings.TransactionErrors</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body table-responsive">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>@deOROWeb.Resources.Strings.Source</th>
                            <th>@deOROWeb.Resources.Strings.Count</th>
                        </tr>
                    </thead>
                    <tbody>
                        @{ int y = 1;}
                        @foreach (var m in Model.transactionErrors)
                        {
                            <tr>
                                <td>@y.</td>
                                <td>@m.source</td>
                                <td><span class="badge bg-yellow">@m.count</span></td>
                            </tr>
                            
                            y++;
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

<div class="row">
    <div class="col-lg-12">
        <div class="small-box bg-aqua">
            <div class="inner">
             
                    <h3>Live Chart</h3>
               
                <p>Locations Total Sales</p>
            </div>
            <div class="icon">
                <i class="ion ion-stats-bars"></i>
            </div>
        </div>
    </div>
   
</div>


<div class="row">
    <div class="box">
        <div class="col-lg-12" style="vertical-align: central;">
            <div class="box-header with-border">
                <h3 class="box-title">Live Sales Section</h3>
            </div>
            <div class="box-body">
                <canvas id="SalesTransactionsChart" width="400" height="150"></canvas>
            </div>
        </div>
    </div>
</div>




<script src="~/Scripts/Chart.bundle.js"></script>

<script>

    $(document).ready(function () {

        var ctx = document.getElementById("SalesTransactionsChart").getContext('2d');

        var data = {
            labels: ["0.0.0", "0.0.0", "0.0.0", "0.0.0", "0.0.0", "0.0.0", "0.0.0"],
            datasets: [
                {
                    label: "Sales Total Amount",
                    fill: false,
                    lineTension: 0.1,
                    backgroundColor: "rgba(75,192,192,0.4)",
                    borderColor: "rgba(75,192,192,1)",
                    borderCapStyle: 'butt',
                    borderDash: [],
                    borderDashOffset: 0.0,
                    borderJoinStyle: 'miter',
                    pointBorderColor: "rgba(75,192,192,1)",
                    pointBackgroundColor: "#fff",
                    pointBorderWidth: 1,
                    pointHoverRadius: 5,
                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointHoverBorderWidth: 2,
                    pointRadius: 5,
                    pointHitRadius: 10,
                    data: [0, 0, 0, 0, 0, 0, 0],
                }
            ]
        };

        var myChart = new Chart(ctx, data);



        function adddata() {
            $.ajax({
                type: "POST",
                url: "@Request.ApplicationPath/ShoppingCart/GetLiveShoppingCarts",
                data: "{ 'fromDate':'" + Date.now().toString() + "'}",
                contentType: "application/json; charset=utf-8",
                datatype: "json",
                success: function (result) {
                    $.each(result, function (i, val) {

                        var currentdate = new Date();

                        myLineChart.data.datasets[0].data[0] = myLineChart.data.datasets[0].data[1];
                        myLineChart.data.datasets[0].data[1] = myLineChart.data.datasets[0].data[2];
                        myLineChart.data.datasets[0].data[2] = myLineChart.data.datasets[0].data[3];
                        myLineChart.data.datasets[0].data[3] = myLineChart.data.datasets[0].data[4];
                        myLineChart.data.datasets[0].data[4] = myLineChart.data.datasets[0].data[5];
                        myLineChart.data.datasets[0].data[5] = myLineChart.data.datasets[0].data[6];
                        myLineChart.data.datasets[0].data[6] = val;


                        myLineChart.data.labels[0] = myLineChart.data.labels[1];
                        myLineChart.data.labels[1] = myLineChart.data.labels[2];
                        myLineChart.data.labels[2] = myLineChart.data.labels[3];
                        myLineChart.data.labels[3] = myLineChart.data.labels[4];
                        myLineChart.data.labels[4] = myLineChart.data.labels[5];
                        myLineChart.data.labels[5] = myLineChart.data.labels[6];
                        myLineChart.data.labels[6] = currentdate.getHours() + ":" + currentdate.getMinutes() + ":" + currentdate.getSeconds();

                        myLineChart.update();

                    });
                },
                error: function (error) {
                    // alert("There was an error getting the data from the server: " + error.responseText);


                    var currentdate = new Date();

                    myLineChart.data.datasets[0].data[0] = myLineChart.data.datasets[0].data[1];
                    myLineChart.data.datasets[0].data[1] = myLineChart.data.datasets[0].data[2];
                    myLineChart.data.datasets[0].data[2] = myLineChart.data.datasets[0].data[3];
                    myLineChart.data.datasets[0].data[3] = myLineChart.data.datasets[0].data[4];
                    myLineChart.data.datasets[0].data[4] = myLineChart.data.datasets[0].data[5];
                    myLineChart.data.datasets[0].data[5] = myLineChart.data.datasets[0].data[6];
                    myLineChart.data.datasets[0].data[6] = 0;


                    myLineChart.data.labels[0] = myLineChart.data.labels[1];
                    myLineChart.data.labels[1] = myLineChart.data.labels[2];
                    myLineChart.data.labels[2] = myLineChart.data.labels[3];
                    myLineChart.data.labels[3] = myLineChart.data.labels[4];
                    myLineChart.data.labels[4] = myLineChart.data.labels[5];
                    myLineChart.data.labels[5] = myLineChart.data.labels[6];
                    // myLineChart.data.labels[6] = currentdate.getHours() + ":" + currentdate.getMinutes() + ":" + currentdate.getSeconds();
                    myLineChart.data.labels[6] = "Failed Data Request";


                    myLineChart.update();
                }
            })
        }

        var option = {
            showLines: true
        };

        var myLineChart = Chart.Line(ctx, {
            data: data,
            options: option
        });

        setInterval(function () {
            //updateData(data);
            adddata();
            //myChart = new Chart(ctx, data);
        }, 10000
            );
    });

</script>


